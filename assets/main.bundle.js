class S{constructor(){this.favorites=this.fetchFavorites(),this.displayCountEls=document.querySelectorAll("[data-js-favorites-count]"),this.updateDisplayCount(),console.debug("Favorites",this.favorites)}fetchFavorites(){const t=localStorage.getItem("favorites");let e=[];if(t)try{const s=JSON.parse(t);Array.isArray(s)&&(e=s)}catch(s){console.error("Error parsing favorites from localStorage",s)}return e}removeFavorite(t){this.favorites=this.favorites.filter(e=>e.handle!==t.handle),console.debug("Favorites after removal",this.favorites),this.updateLocalStorage(this.favorites),this.updateDisplayCount()}addFavorite(t){this.favorites.push(t),console.debug("Favorites after addition",this.favorites),this.updateLocalStorage(this.favorites),this.updateDisplayCount()}updateDisplayCount(){this.displayCountEls.forEach(t=>{t.textContent=this.favorites.length,this.favorites.length===0?t.classList.add("opacity-0"):t.classList.remove("opacity-0")})}updateLocalStorage(t){localStorage.setItem("favorites",JSON.stringify(t))}}const m=new S;class T extends HTMLElement{constructor(){super(),this.productGrid=this.querySelector("[data-product-grid]"),this.spinner=this.querySelector("[data-spinner]"),this.emptyStateEl=this.querySelector("[data-empty-state]"),m.favorites.length>0?this.fetchProducts():(this.emptyStateEl.classList.remove("hidden"),this.spinner.classList.add("hidden"))}async fetchProductHTML(t){let e=`/products/${t.handle}?view=card`;t.variantId&&(e+=`&variant=${t.variantId}`);const s=await fetch(e).then(p=>p.text());return new DOMParser().parseFromString(s,"text/html").querySelector(".product-item")}batchArray(t,e){const s=[];for(let i=0;i<t.length;i+=e)s.push(t.slice(i,i+e));return s}async fetchProducts(){const t=this.batchArray(m.favorites,4);await Promise.all(t.map(async e=>{const s=await Promise.all(e.map(async i=>this.fetchProductHTML(i)));return s.forEach(i=>{try{return this.productGrid.appendChild(i)}catch{}}),s})),this.spinner.classList.add("hidden")}}customElements.define("favorite-products",T);class x extends HTMLElement{constructor(){super(),this.productHandle=this.dataset.productHandle,this.variantId=this.dataset.variantId,this.favoriteItem={handle:this.productHandle},this.variantId&&(this.favoriteItem.variantId=this.variantId),this.addEventListener("click",this.handleClick.bind(this)),this.updateState()}get isFavorite(){return m.favorites.some(t=>JSON.stringify(t)===JSON.stringify(this.favoriteItem))}handleClick(){this.isFavorite?this.removeFavorite():this.addFavorite(),this.updateState()}removeFavorite(){m.removeFavorite(this.favoriteItem)}addFavorite(){m.addFavorite(this.favoriteItem)}updateState(){this.isFavorite?this.setAttribute("added",""):this.removeAttribute("added")}}customElements.define("add-favorite",x);class C extends HTMLElement{constructor(){super(),console.debug("ReloadOnEvent constructor"),this.event=this.getAttribute("data-event"),this.section=this.closest(".shopify-section"),this.sectionId=this.section.id,this.shopifySectionId=this.sectionId.replace("shopify-section-",""),this.container=this.section.querySelector("[data-section-type]"),this.sectionType=this.container.getAttribute("data-section-type"),this.init()}init(){this.url=new URL(window.location.href),this.url.searchParams.set("sections",this.shopifySectionId),console.debug("ReloadOnEvent init, adding event listener for",this.event),document.addEventListener(this.event,this.handleChange.bind(this))}handleChange(t){console.debug("ReloadOnEvent handleChange, reloading - event.detail:",t.detail),t.detail.variant&&this.url.searchParams.set("variant",t.detail.variant.id),this.reload()}async reload(){await this.setNewHTML(),window.Shopify.theme.sections.unload(this.container);const t=this.querySelector(`[data-section-type="${this.sectionType}"]`);if(!t){console.error(`ReloadOnEvent reload: Failed to find the new container element with type [${this.sectionType}] after updating innerHTML.`);return}this.container=t,window.Shopify.theme.sections.load(this.sectionType,this.container),this.dispatchEvent(new CustomEvent("reload-on-event:loaded",{bubbles:!0,detail:{sectionId:this.sectionId,shopifySectionId:this.shopifySectionId}}))}async setNewHTML(){try{const t=await this.fetchSectionHTML();if(!t){console.error("ReloadOnEvent setNewHTML: Fetched HTML is empty or null for section",this.shopifySectionId);return}const i=new DOMParser().parseFromString(t,"text/html").getElementById(this.sectionId);if(i){const o=this.findSelfInHTML(i);o?this.innerHTML=o.innerHTML:console.warn('ReloadOnEvent setNewHTML: Could not find "self" (<reload-on-event>) element within the fetched section HTML using findSelfInHTML.')}else console.warn("ReloadOnEvent setNewHTML: Could not find the parent Shopify section element in the fetched HTML. Section ID:",this.sectionId)}catch(t){console.error("ReloadOnEvent setNewHTML: Error fetching or parsing HTML:",t)}}async fetchSectionHTML(){console.debug("ReloadOnEvent fetchSectionHTML, url",this.url);const t=await fetch(this.url).then(e=>e.json());return console.debug("ReloadOnEvent fetchSectionHTML, sectionJSON",t),t[this.shopifySectionId]}findSelfInHTML(t){const e=[];let s=this;for(;s;){let i=s.tagName.toLowerCase();if(s.parentElement){const o=Array.from(s.parentElement.children).indexOf(s)+1;o>1&&(i+=`:nth-child(${o})`)}if(e.unshift(i),s=s.parentElement,s&&s.id===this.sectionId)break}return t.querySelector(e.join(" > "))}}customElements.define("reload-on-event",C);class I extends HTMLElement{constructor(){super(),this.select=this.querySelector("#marketSelector")}connectedCallback(){this.select&&this.setupEventListeners()}setupEventListeners(){this.select.addEventListener("change",t=>this.handleMarketChange(t))}handleMarketChange(t){const s=t.target.selectedOptions[0].dataset.url;s&&(window.location.href=s)}}customElements.define("currency-selector",I);class M extends HTMLElement{constructor(){super(),Shopify.designMode&&(this.blockSelectHandler=this.blockSelectHandler||this.handleBlockSelect.bind(this),this.section.addEventListener("shopify:block:select",this.blockSelectHandler))}connectedCallback(){this.init(),this.addEventListener("click",this.handleClick.bind(this))}init(){const{sectionId:t,activeTextClass:e}=this.dataset;this.section=document.getElementById(t),this.activeTextClass=e,this.backgroundBlob=this.querySelector(".background-blob");const s=this.querySelector("[data-navigate-tab]");if(!s)return console.warn("section-tab-navigator doesn't include any navigation links",this);this.navigate(s)}handleClick(t){const e=t.target.closest("[data-navigate-tab]");return e?(this.navigate(e),!0):!1}navigate(t){this.updateUI(t);const e=t.dataset.navigateTab;this.section.querySelectorAll("[data-tab]").forEach(i=>{if((e==="all"||e==="alla")&&!i.hasAttribute("data-not-all"))return i.classList.remove("js-hidden");const u=i.dataset.tab.split(",").includes(e);i.classList.toggle("js-hidden",!u)}),this.target=t,this.section.dispatchEvent(new CustomEvent("sectionTabNavigated",{detail:{tabName:e}}))}updateUI(t){if(this.target&&this.activeTextClass&&this.target.classList.remove(this.activeTextClass),t&&this.backgroundBlob){this.activeTextClass&&t.classList.add(this.activeTextClass);const e=t.getBoundingClientRect(),s=t.offsetParent.getBoundingClientRect();this.backgroundBlob.style.width=`${e.width}px`,this.backgroundBlob.style.left=`${e.left-s.left}px`}}handleBlockSelect(t){if(handleClick(t))return;const s=t.target;if(!s)return console.warn("No block selected");if(t.target.classList.contains("js-hidden")){let i=[];if(tabEl.hasAttribute("data-tab")&&(i=tabEl.dataset.tab.split(",")),tabEl.hasAttribute("data-flickity-tab")&&(i=s.dataset.flickityTab.split(",")),i.length>0){const o=slideTabs[0];this.navigate(o)}}}}customElements.define("section-tab-navigator",M);class k extends HTMLElement{constructor(){super()}connectedCallback(){this.init(),this.addEventListener("input",this.handleInput.bind(this))}init(){this.activeTextClass=this.dataset.activeTextClass,this.backgroundBlob=this.querySelector(".background-blob");const t=this.querySelector('input[type="radio"]:checked');if(!t)return console.warn("section-tab-navigator doesn't include any navigation links",this);this.handleInput({target:t})}handleInput(t){const e=t.target.closest("li");return e?(this.updateUI(e),!0):!1}updateUI(t){if(this.target&&this.activeTextClass&&this.target.classList.remove(this.activeTextClass),t&&this.backgroundBlob){this.activeTextClass&&t.classList.add(this.activeTextClass);const e=t.getBoundingClientRect(),s=t.offsetParent.getBoundingClientRect();this.backgroundBlob.style.width=`${e.width}px`,this.backgroundBlob.style.left=`${e.left-s.left}px`,this.backgroundBlob.style.top=`${e.top-s.top}px`,this.target=t}}}customElements.define("radio-blob",k);function v(n){setTimeout(()=>{requestAnimationFrame(n)},0)}function E(n,t){return n.length<=t?n:n.slice(0,t)+"..."}class H extends HTMLElement{constructor(){super(),this.expanded=!1}connectedCallback(){this.chars=parseInt(this.dataset.chars,10)||null,this.lines=parseInt(this.dataset.lines||3,10),this.init()}init(){this.originalContent=this.innerHTML,this.wrapper=document.createElement("div"),this.wrapper.classList.add("expand-text-wrapper"),this.contentEl=document.createElement("div"),this.contentEl.classList.add("expand-text-content"),this.button=document.createElement("button"),this.button.type="button",this.button.classList.add("expand-text-toggle","mt-2","text-sm","font-medium","underline","focus:outline-none","hidden"),this.button.textContent="See more",this.button.addEventListener("click",()=>this.toggleExpand());let t;if(this.chars!==null)t=this.chars;else{const e=document.createElement("div");e.style.position="absolute",e.style.visibility="hidden",e.style.width="auto",e.style.height="auto",e.innerHTML=this.originalContent,document.body.appendChild(e);const s=this.parentElement?this.parentElement.offsetWidth:500;e.style.width=`${s}px`;const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyz 0123456789",o=document.createElement("div");o.textContent=i,o.style.whiteSpace="nowrap",e.appendChild(o);const u=i.length,p=o.offsetWidth;t=Math.floor(s/p*u)*this.lines,document.body.removeChild(e)}this.setupContent(t),this.innerHTML="",this.wrapper.appendChild(this.contentEl),this.appendChild(this.wrapper),this.appendChild(this.button)}setupContent(t){const e=document.createElement("div");e.innerHTML=this.originalContent;const s=e.textContent||e.innerText||"";if(s.length>t){this.fullContent=this.originalContent;let o=t;for(;o>0&&s.charAt(o)!==" "&&s.charAt(o)!==".";)o--;o===0&&(o=t);const u=E(s,o);this.contentEl.textContent=u,this.button.classList.remove("hidden"),this.truncated=!0,this.maxChars=o}else this.contentEl.innerHTML=this.originalContent,this.truncated=!1}toggleExpand(){if(this.expanded=!this.expanded,this.expanded)this.contentEl.innerHTML=this.originalContent,this.button.textContent="See less";else{const t=document.createElement("div");t.innerHTML=this.originalContent;const e=t.textContent||t.innerText||"",s=E(e,this.maxChars);this.contentEl.textContent=s,this.button.textContent="See more"}}}customElements.define("expand-text",H);const{icons:h}=window.theme;async function O({childSelector:n,galerySelector:t,mainClass:e,addListener:s=!1}){const i=document.querySelectorAll(n);if(!i.length)return;const o=a=>{const r=a.dataset.pswpType||"image",c=parseInt(a.dataset.pswpWidth,10),d=parseInt(a.dataset.pswpHeight,10);(isNaN(c)||isNaN(d))&&console.warn("Lightbox element missing valid width/height data attributes:",a);const l={type:r,width:c||0,height:d||0,element:a};return r==="video"||(l.src=a.getAttribute("href")||a.dataset.pswpSrc,l.src||console.warn("Image lightbox element missing href and data-pswp-src:",a)),l},u=Array.from(i).map(o),p=await import(window.flu.chunks.photoswipe),{PhotoSwipeLightbox:g,PhotoSwipe:w}=p;if(!g||!w){console.error("PhotoSwipe modules not found in the imported chunk.");return}const f=new g({gallery:t,children:n,showHideAnimationType:"zoom",pswpModule:w,mainClass:e,bgOpacity:1,arrowPrevSVG:h==null?void 0:h.chevron,arrowNextSVG:h==null?void 0:h.chevron,closeSVG:h==null?void 0:h.close,zoomSVG:h==null?void 0:h.zoom,dataSource:u});f.on("contentLoad",a=>{const{content:r}=a,c=r.data;if(console.log("contentLoad",a,c),c.type==="video"){const d=c.element;console.log("videoElement",d.dataset);const l=(d==null?void 0:d.dataset.pswpVideo)||(d==null?void 0:d.getAttribute("href"));d&&l?(a.preventDefault(),r.element=A(l)):(console.warn("PhotoSwipe: Video item type detected, but failed to find video source on element:",d),r.state="error")}}),f.on("contentActivate",a=>{const{content:r}=a,c=r.element;if(r.data.type==="video"){console.log("contentActivate",a,r,c);const l=c.querySelector("video");l?(r.state="loading",N(l,r)):(console.error("PhotoSwipe: Failed to find video element within the created container."),r.state="error",r.onError())}}),f.on("contentDeactivate",a=>{const{content:r}=a,c=r.element;if(r.data.type==="video"){console.log("contentDeactivate",a,r,c);const l=c.querySelector("video");l&&l.pause()}}),s&&i.forEach((a,r)=>{a.addEventListener("click",c=>{console.log("opening w custom clicker listneer mate click",c),c.preventDefault(),f.loadAndOpen(r)})});try{f.init()}catch(a){console.error("PhotoSwipe: Failed to initialize lightbox.",a)}}window.customLightbox=O;const A=n=>{const t=document.createElement("div");t.className="pswp__video-wrapper",Object.assign(t.style,{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"#000"});const e=document.createElement("video");return e.src=n,e.controls=!0,Object.assign(e.style,{maxWidth:"100%",maxHeight:"100%",display:"block"}),t.appendChild(e),t},N=(n,t)=>{let e=!1;const s=()=>{e||(e=!0,n.play(),t.onLoaded())},i=o=>{console.error(`PhotoSwipe: Video loading failed for src: ${n.src}`,o),t.onError()};n.addEventListener("loadeddata",s),n.addEventListener("canplay",s),n.addEventListener("error",i),n.addEventListener("stalled",i),n.readyState>=3&&s()};function b(n){const t=e=>{e.dataset.src&&!e.src&&(e.src=e.dataset.src),e.dataset.srcset&&!e.srcset&&(e.srcset=e.dataset.srcset)};n.parentNode.tagName==="PICTURE"?Array.from(n.parentNode.children).forEach(e=>{t(e)}):t(n)}function L(n){return n.forEach(t=>b(t))}function y(){if(!("loading"in HTMLImageElement.prototype)&&"IntersectionObserver"in window){console.log("intersection observer");const n=new IntersectionObserver((t,e)=>{t.forEach(s=>{if(s.isIntersecting){const i=s.target;b(i),e.unobserve(i)}})},{rootMargin:"0px 0px 500px 0px"});document.querySelectorAll('[loading="lazy"]').forEach(t=>{n.observe(t)})}else{const n=[],t=[];document.querySelectorAll('[loading="lazy"], [data-src]').forEach(e=>{if(e.hasAttribute("data-load-dom"))n.push(e);else if(e.hasAttribute("data-load-load"))t.push(e);else{if(e.hasAttribute("data-load-manual"))return;b(e)}}),P(n),F(t)}}function P(n){console.debug("loadImagesOnDOMLoaded",n);const t=()=>v(()=>L(n));if(document.readyState!="loading")return t();document.addEventListener("DOMContentLoaded",t)}function F(n){console.debug("loadImagesOnLoaded",n);const t=()=>v(()=>L(n));if(document.readyState=="complete")return t();window.addEventListener("load",t)}v(y);document.addEventListener("DOMContentLoaded",y);document.addEventListener("shopify:section:load",()=>v(y));class R{constructor(){this.timeoutDuration=1e4,this.videoStates=new Map,this.observer=null,this.init()}init(){this.observer=new IntersectionObserver(this.handleIntersection.bind(this),{threshold:.5}),this.observeVideos()}observeVideos(){document.querySelectorAll("video").forEach(t=>{this.observer.observe(t),this.videoStates.set(t,{timeoutId:null})})}handleIntersection(t){t.forEach(e=>{const s=e.target,i=this.videoStates.get(s);i&&(e.isIntersecting?(i.timeoutId&&(clearTimeout(i.timeoutId),i.timeoutId=null),s.dataset.autoPaused==="true"&&(s.play(),s.dataset.autoPaused=!1)):!s.muted&&!s.paused&&(s.pause(),s.dataset.autoPaused=!0,i.timeoutId=setTimeout(()=>{console.log("removing autoPaused",s),s.dataset.autoPaused=!1,i.timeoutId=null},this.timeoutDuration)))})}destroy(){this.videoStates.forEach(t=>{t.timeoutId&&clearTimeout(t.timeoutId)}),this.observer.disconnect(),this.videoStates.clear()}}new R;document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("click",n=>{const t=n.target.tagName==="A"?n.target:n.target.closest("a");t&&t.tagName==="A"&&window.location.hostname!==new URL(t.href).hostname&&(t.target="_blank")}),document.addEventListener("click",n=>{n.target.tagName==="A"&&window.location.hostname===new URL(n.target.href).hostname&&n.target.href.includes("#")&&(document.getElementsByTagName("html")[0].style.scrollBehavior="smooth",setTimeout(()=>{document.getElementsByTagName("html")[0].style.scrollBehavior=""},1e3))})});window.theme=window.theme||{};console.log("main.bundle.js loaded");document.dispatchEvent(new CustomEvent("theme:loaded"));
//# sourceMappingURL=main.bundle.js.map
